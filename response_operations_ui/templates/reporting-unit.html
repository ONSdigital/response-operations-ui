{% extends "layouts/base.html" %}
{% from "components/button/_macro.njk" import onsButton %}
{% from "components/table/_macro.njk" import onsTable %}

{% set page_title = ru.name + " | Reporting units" %}

{% block main %}
  {% include 'partials/flashed-messages.html' %}

  <h1 id="RU_NAME" class="u-fs-xl">{{ ru.name }}</h1>

  <dl id="RU_DETAILS" class="item-headlines">
    <dt class="item-headlines-term">
      Reference:
    </dt>
    <dd id="RU_REF" class="item-headlines-definition">
      {{ ru.sampleUnitRef }}
    </dd>
    {% if ru.trading_as %}
      <dt class="item-headlines-term">
        Trading as:
      </dt>
      <dd id="TRADING_AS" class="item-headlines-definition">
        {{ ru.trading_as }} &#160;
      </dd>
    {% endif %}
  </dl>

  {% include 'partials/reporting-unit-tabs.html' %}

  {% 
    set surveyTableData = {
      "table_class": 'table--responsive table--dense',
      "id": 'tbl-surveys',
      "ths": [
        {
          "value": "Survey"
        },
        {
          "value": "Current period"
        },
        {
          "value": "Status"
        }
      ]
    }
  %}

  {% set surveyTableDataRows = [] %}

  {% for survey in surveys %}
    {% do surveyTableDataRows.append( 
      {
        "tds": [
          {
            "value": survey[0],
            "data": "Survey",
            "name": "tbl-surveys-survey"
          },
          {
            "value": survey[1].collectionExercise,
            "data": "Current period",
            "name": "tbl-surveys-period"
          },
          {
            "value": survey[1].caseStatus,
            "data": "Status",
            "name": "tbl-surveys-status"
          }
        ]
      }
    ) %}
  {% endfor %}

  {% do surveyTableData | setAttribute("trs", surveyTableDataRows) %}
  {{
    onsTable(surveyTableData)
  }}
{% endblock %}
