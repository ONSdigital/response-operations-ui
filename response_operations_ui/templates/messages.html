{% extends "layouts/base.html" %}
{% block page_title %}Messages | Survey Data Collection{% endblock %}

{% block main %}
</br>

<div role="main" id="main" class="page__main">
  <h1 class="jupiter" name="page-messages-title">Messages</h1>
  <div class="grid">
    <div class="grid__col col-30@l">
      <div class="messages-list">

        <table id="tbl-messages" class="table__dense" summary="messages in the system">
          <thead class="table--head">
            <tr class="table--row">
              <th scope="col" class="table--header--cell tbl-messages-RU-Ref">
                RU_Ref
              </th>
              <th scope="col" class="table--header--cell tbl-messages-business">
                Business
              </th>
              <th scope="col" class="table--header--cell tbl-messages-subject">
                Subject
              </th>
              <th scope="col" class="table--header--cell tbl-messages-from">
                From
              </th>
              <th scope="col" class="table--header--cell tbl-messages-to">
                To
              </th>
              <th scope="col" class="table--header--cell tbl-messages-received">
                Received
              </th>
            </tr>
          </thead>

              <tbody>
              {%if not messages %}
                <p>There are no messages for this user</p>
              {% else %}
              {% for message in messages %}
               <tr class="table--row table--row__selectable">
                <td name="tbl-messages-RU_Ref" class="table--cell tbl-messages-RU_Ref">
                    {{ message.ru_id }}
                </td>
                <td name="tbl-messages-business" class="table--cell tbl-messages-business">
                    {{ message['@ru_id']['name'] }}
                </td>
                <td name="tbl-messages-subject" class="table--cell tbl-messages-subject">
                    {{ message.subject }}
                </td>
                <td name="tbl-messages-from" class="table--cell tbl-messages-from">
                    {{ message.msg_from }}
                </td>
                <td name="tbl-messages-to" class="table--cell tbl-messages-to">
                    {{ message['@msg_to'][0]['firstName'] }} {{ message['@msg_to'][0]['lastName'] }}
                </td>
                <td name="tbl-messages-received" class="table--cell tbl-messages-received">
                   <time datetime="{{message.received}}">{{ message.sent_date }}</time>
                </td>
               </tr>
              {% endfor %}
              {% endif %}

          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}
