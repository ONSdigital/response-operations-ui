<section class="ons-u-mt-s">
    {% if sample %}
        {% if 'ACTIVE' == sample.state %}
            {{
                onsTable({
                    "variants": ['compact', 'responsive'],
                    "id": "sample-table",
                    "caption": 'Loaded sample summary',
                    "hideCaption": true,
                    "ths": [
                        { 
                            "value": "Sample",
                            "thClasses": "ons-u-fs-r--b"
                        },
                        {
                            "value": "Sample loaded: " + '<em>' + sample.ingestDateTime[:-7] + '</em>' + sample.ingestDateTime[-7:],
                            "thClasses": "ons-u-fs-r",
                            "numeric": "true"
                        }
                    ],
                    "trs": [
                        {
                            "tds": [
                                {
                                    "value": "Total businesses"
                                },
                                {
                                    "value": sample.totalSampleUnits,
                                    "name": "total-businesses",
                                    "numeric": "true"
                                }
                            ]
                        },
                        {
                            "tds": [
                                {
                                    "value": "Collection instruments needed"
                                },
                                {
                                    "value": sample.expectedCollectionInstruments,
                                    "name": "total-ci",
                                    "numeric": "true"
                                }
                            ]
                        }
                    ]
                })
            }}
        {% elif 'INIT' == sample.state %}
            <div class="ons-u-mb-xl">
                <div class="ons-u-fs-r">
                    Loading&hellip; <span class="ons-u-ml-xs"><a href="/surveys/{{survey.shortName}}/{{ce.exerciseRef}}/view-sample-ci?show_msg=true">Refresh to see progress</a></span>
                </div>
            </div>
        {% elif 'FAILED' == sample.state %}
            <div class="ons-u-mb-xl">
                {% call
                    onsPanel({
                        "type": "error",
                        "classes": "ons-u-mb-l"
                    })
                %}
                    {{ sample.notes }}
                {% endcall %}
                {% if not locked and surveyEditPermission %}
                    <a class="ons-u-ml-xs" id="remove_sample_btn_2" href="{{ url_for('collection_exercise_bp.get_confirm_remove_sample', short_name=survey.shortName, period=ce.exerciseRef) }}">Remove</a>
                {% endif %}
            </div>
        {% endif %}
        {% if surveyEditPermission and not locked %}
            {{
                onsButton({
                    "text": 'Replace sample file',
                    "id": 'btn-replace-sample-file',
                    "submitType": 'timer',
                    "variants": ['secondary', 'small'],
                    "url": url_for('collection_exercise_bp.get_confirm_remove_sample', short_name=survey.shortName, period=ce.exerciseRef),
                    "noIcon": 'true'
                })
            }}
        {% endif %}
    {% elif not sample %}
         {{
            onsTable({
                "variants": ['compact', 'responsive'],
                "id": "sample-table",
                "caption": 'Upload sample file',
                "hideCaption": true,
                "ths": [
                    { 
                        "value": "Sample",
                        "thClasses": "ons-u-fs-r--b"
                    }
                ],
                "trs": [
                        {
                            "tds": [
                                {
                                    "value": "No sample file uploaded"
                                }
                            ]
                        },
                    ]
            })
        }}
        {% if surveyEditPermission and not locked %}
            {{
                onsButton({
                    "text": 'Upload sample file',
                    "id": 'btn-upload-sample-file',
                    "submitType": 'timer',
                    "variants": ['secondary', 'small'],
                    "url": url_for('collection_exercise_bp.get_upload_sample_file', short_name=survey.shortName, period=ce.exerciseRef),
                    "noIcon": 'true'
                })
            }}
        {% endif %}
    {% endif %}
</section>
