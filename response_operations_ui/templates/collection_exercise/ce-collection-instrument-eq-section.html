<div id="ciSelectionForm" class="{{'ons-panel ons-panel--error ons-panel--no-title' if 'ciSelect' in error['section'] else ''}} 
ons-u-mt-l">
    <span class="ons-panel__assistive-text ons-u-vh">Error: </span>
    {% if 'ciSelect' in error['section'] %}
        <div class="ons-panel__body">
          <p class="ons-panel__error ons-u-mb-s">
            <strong>{{ error['header'] }}</strong>
          </p>
        </div>
    {% endif %}
    {% if eq_ci_selectors or collection_instruments['EQ'] %}
        <form id="form-select-ci" action="" class="form" method="post" enctype="multipart/form-data">
            {{
                onsLabel({
                    "id": 'ci-selector',
                    "classes": ' ons-u-mb-s',
                    "text": 'Select EQ collection instruments'
                })
            }}
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
            <input type="hidden" name="csrf_token" value="" />
            <input type="hidden" name="ce_id" value="{{ ce.id }}" />                                       
            <table class="ons-table">
                {% set selectAllText = "Select all" %}
                {% set unselectAllText = "Unselect all" %}
                {% if collection_instruments['EQ']|length == complete_ci_dict|length %}
                    {% set autoSelectState = unselectAllText %}
                {% else %}
                    {% set autoSelectState = selectAllText %}
                {% endif %}
                {{ 
                    onsButton({
                        "html": '<span class="ons-js-button-text" id="selection-text">' + autoSelectState + '</span>',
                        "variants": btnClasses,
                        "classes": 'ons-u-mb-m ons-btn--small ons-btn--secondary',
                        "id": "select-or-unselect-ci",
                        "attributes": {
                            "data-unselect-all": unselectAllText,
                            "data-select-all": selectAllText
                        }
                    })
                }}
                <thead class="ons-table__head">
                    {# Blank <tr> Required to give the correct formatting for the table #}
                    <tr class="ons-table__row"></tr>
                </thead>
                <tbody class="ons-table__body" >
                    {% for eq_ci in complete_ci_dict|batch(3, ' ') %} 
                        <tr class="ons-table__row" style="border-bottom: 1px #222222">
                            {% for ci in eq_ci %}
                                {% if ci['form_type'] %}
                                    <td class="ons-table__cell" style="border-right: 10px solid white;">
                                          {{
                                            onsCheckbox({
                                                "id": "ci-check",
                                                "label": {
                                                    "text": ci['form_type']
                                                },
                                                "value": ci['id']|string,
                                                "checked": true if ci['checked'] == 'true' else false,
                                                "name": "checkbox-answer",
                                                "classes": "ons-checkbox--no-border"
                                            })
                                        }}
                                    </td>
                                {% endif %}
                            {% endfor %}
                        </tr>
                    {% endfor %}
                    {# Blank <tr> Required to give the correct formatting for the table #}
                    <tr class="ons-table__row"></tr>
                </tbody>
            </table>
            <p id="ci-checked-count">{{ collection_instruments['EQ']|length }} selected out of {{ complete_ci_dict|length }} available</p>
            <div class="ons-u-mt-xxs">
                {{
                    onsButton({
                        "text": "Done",
                        "id": "btn-add-ci",
                        "name": "select-eq-ci"
                    })
                }}
            </div>
        </form>
    {% endif %}
</div>
<div class="ons-grid ons-grid--flex ons-grid--between">
    <div class="ons-grid__col">
        <h1 class="ons-u-fs-l u-mb-xs" name="page-manage-account-title">{{ name }}</h1>
    </div>
</div>
