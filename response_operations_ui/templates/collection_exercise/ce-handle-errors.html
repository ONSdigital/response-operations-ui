{#- Display processing or error panel if validation failed #}
{% if processing %}
    {% call panel.render(id='processing-info') %}Processing collection exercise â€“ <a id="a-processing-refresh" href="">refresh to see progress</a>{% endcall %}
{% elif validation_failed %}
    {% call panel.render(id='validation-error', type='error') %}
        Error processing collection exercise
        {% if missing_ci %}
        <div id="collection-instrument-error">
        <a href="#ciFile">Check collection instruments</a>
        </div>
        {% endif %}
    {% endcall %}
{% endif %}

{# Display header message if section header #}
{% if error['section'] == 'head' %}
    {% call panel.render(id='validation-error', type='error', header=error['header']) %} {{ error['message'] }} {% endcall %}
<div class="panel panel--error u-mb-s" data-qa="error">
    <div class="panel__header">
        <h1 class="panel__title venus">{{ error['header'] }}</h1>
    </div>
    <div class="panel__body" data-qa="error-body">
        {{ error['message'] }}
    </div>
</div>
{% endif %}

{# Show state message panels #}
{% if sample and show_msg == 'true' %}
    {% if sample.state == 'INIT' %}
    <div class="panel panel--simple panel--info u-mb-l">
        <div class="panel__body">
        Loading sample&hellip; <span class="u-ml-xs"><a href="/surveys/{{survey.shortName}}/{{ce.exerciseRef}}?show_msg=true">Refresh to see progress</a></span>
        </div>
    </div>
    {% elif sample.state == 'ACTIVE' %}
    <div class="panel panel--simple panel--success u-mb-l" id="sample-success">
        <div class="panel__body" >
        Sample loaded successfully
        </div>
    </div>
    {% elif sample.state == 'FAILED' %}
    <div class="panel panel--simple panel--error u-mb-l">
        <div class="panel__body">
        Error loading sample <span class="u-ml-xs"><a href="#section-sample">See error details</a></span>
        </div>
    </div>
    {% endif %}
{% endif %}