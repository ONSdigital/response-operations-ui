{% extends "layouts/base.html" %}
{% block page_title %}{{ce.shortName}} {{period}}{% endblock %}

{% block main %}
<div class="container page__container">
  <div role="main" id="main" class="page__main">
    <br/>
    <h1 class="jupiter">{{survey.shortName}} {{ce.exerciseRef}}</h1>

    <div class="grid">
      <div class="grid__col col-5@l">

        <div class="ce-section">
          <h2 class="venus u-pt-m">Sample</h2>
          {% if sample %}
            <table class="table table__dense" summary="Dates for this collection exercises">
              <tbody>
                <tr class="table--row">
                  <td class="table--cell tbl-ce-label">
                    Total businesses
                  </td>
                  <td class="table--cell tbl-ce-value" name="mps">
                    {{sample.businesses}}
                  </td>
                </tr>

                <tr class="table--row">
                  <td class="table--cell tbl-ce-">
                    Collection instruments
                  </td>
                  <td class="table--cell tbl-ce-" name="go-live-date">
                    {{sample.collection_instruments}}
                  </td>
                </tr>
              </tbody>
            </table>
            <p>Sample loaded: {{sample.submission_time}}</p>
          {% else %}
            <div class="u-mb-m">
              <form id="form-load-sample"
                    method="post"
                    action="{{ url_for('upload_sample', short_name=survey.shortName, period=ce.exerciseRef) }}"
                    class="form"
                    enctype="multipart/form-data">
                <p>
                  Choose a sample file to check details before loading
                </p>
                <label class="upload-file u-vh" for="file">Choose file</label>
                <input type="file" class="" name="sampleFile" id="file" onchange="handleFiles(this.files)"
                accept=".csv">
                <div id="output" class="u-mb-s">
                </div>
                <button id="btn-check-sample-contents" class="btn btn--primary unready" type="button" disabled="">Check sample contents</button>
                <button id="btn-load-sample" class="btn btn--primary hidden" type="submit">Load sample</button>
                <button id="btn-cancel-load-sample" class="btn btn--secondary hidden" type="button" onclick="cancelLoadSample()">Cancel</button>
              </form>
            </div>
          {% endif %}
        </div>
      </div>

      <div class="grid__col col-1@l"></div>

      <div class="grid__col col-6@l">
        <div class="ce-section ce-details">
          <h2 class="venus u-pt-m">Reference information for this collection exercise</h2>

          <table class="table table__dense" summary="Collection exercise details">
            <tbody>
              <tr class="table--row">
                <td class="table--cell tbl-ce-label">
                  Survey ID / Abbreviation / Title
                </td>
                <td class="table--cell tbl-ce-value" name="survey-info">
                  {{survey.surveyRef}} - {{survey.longName}} ({{survey.shortName}})
                </td>
              </tr>

              <tr class="table--row">
                <td class="table--cell tbl-ce-">
                  Period
                </td>
                <td class="table--cell tbl-ce-" name="period">
                  {{ce.exerciseRef}}
                </td>
              </tr>

              <tr class="table--row">
                <td class="table--cell tbl-ce-">
                  Shown to respondent as
                </td>
                <td class="table--cell tbl-ce-" name="user-description">
                  {{ce.userDescription}}
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}