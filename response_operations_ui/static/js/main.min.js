(function(e){const t={},n={_getErrorContainer:function(){return document.getElementById("error-alerts")},_clearAlerts:function(){n._getErrorContainer().innerHTML=""},_getPanelTemplateHtml:function(e,t,n){let a="";return a+='<div class="u-mt-l panel panel--'+(n||"error")+'">',a+='    <div class="panel__header">',a+='        <div class="u-fs-r--b">'+e+"</div>",a+="    </div>",a+='    <div class="panel__body">',a+="        <div>"+t+"</div>",a+="    </div>",a+="</div>",a},_getSimplePanelTemplateHtml:function(e,t){let n="";return n+='<div class="u-mt-l panel panel--simple panel--'+(t||"error")+'">',n+='    <div class="panel__body">',n+="        <div>"+e+"</div>",n+="    </div>",n+="</div>",n},_showAlert:function(e,t,a){return n._clearAlerts(),n._getErrorContainer().innerHTML=e?n._getPanelTemplateHtml(e,t,a||!1):n._getSimplePanelTemplateHtml(t,a||!1)}};["success","error","warn","info"].forEach(function(e){t[e]=function(t,a){n._showAlert(t,a,e)}}),e.alerts={__private__:{}},Object.keys(t).forEach(function(n){e.alerts[n]=t[n]}),Object.keys(n).forEach(function(t){e.alerts.__private__[t]=n[t]})})(window),function(e){function t(){const e=document.getElementsByClassName("data-panel-header");for(let t=0;t<e.length;t++){const n=e[t].nextElementSibling;n.style.display="none",e[t].addEventListener("click",function(){const e=this.nextElementSibling;this.classList.toggle("active"),"block"===e.style.display?e.style.display="none":e.style.display="block"})}}function n(){const t=e.location.hash;t&&(document.querySelectorAll(".data-panel-header").classList.addClass("active"),document.querySelectorAll(".data-panel-body").style.display="block")}e.initDataPanels=t,e.openPanel=n}(window),function(e){const t=document.getElementById("create-message-form"),n=document.getElementById("btn-send-message");t&&n&&t.addEventListener("submit",function(e){n.attributes.disabled="disabled"})}(window),function(e){const t=document.getElementById("form-load-sample"),n=document.getElementById("btn-load-sample");t&&n&&t.addEventListener("submit",function(e){n.attributes.disabled="disabled"})}(window),window.readCSV={__private__:{}},window.readCSV.__private__.getOutputTemplate=function(e,t){let n="";return n+="<div class='panel panel--info'>",n+="  <div class='panel__header'>",n+="    <h3 class='u-fs-r--b u-mb-no'>Sample contents</h3>",n+="  </div>",n+="  <div class='panel__body'>",n+="    <div id='sample-preview-businesses'>Number of businesses: "+e+"</div>",n+="    <div id='sample-preview-ci'>Collection instruments: "+t+"</div>",n+="  </div>",n+="</div>",n},window.readCSV.__private__.renderUI=function(e,t){document.getElementById("sample-preview").innerHTML=window.readCSV.__private__.getOutputTemplate(e,t),document.getElementById("btn-check-sample-contents").style.display="none",document.getElementById("btn-load-sample").style.display="inline-block",document.getElementById("btn-cancel-load-sample").style.display="inline-block"},window.readCSV.__private__.errorHandler=function(e){"NotReadableError"==e.target.error.name&&alerts.error("Error Uploading file","The selected file was not readable.")},window.readCSV.__private__.browserHasFileLoaderCapability=function(){return window.hasOwnProperty("FileReader")},window.readCSV.__private__.processFile=function(e,t){const n=e.target.result,a=n.split(/\r\n|\n/),l=[],r=[];let i;for(;a.length;){const e=a.shift().split(":");e&&e.length&&e[0]&&r.push(e)}if(t.indexOf("RU_REF")>-1)i=r.length;else if(t.indexOf("FORM_TYPE")>-1){for(let e=0;e<r.length;e++)l.push(r[e][r[e].length-2]);i=l.filter(function(e,t,n){return n.indexOf(e)===t}).length}window.readCSV.__private__.renderUI(r.length,i)},window.readCSV.handleFiles=function(e,t){if(window.readCSV.__private__.browserHasFileLoaderCapability()){const n=new FileReader;n.onload=function(e){window.readCSV.__private__.processFile(e,t)},n.onerror=window.readCSV.__private__.errorHandler,n.readAsText(e[0])}else alerts.warn("Your browser does not support file uploading.  Uploading of samples will not be possible.")},window.readCSV.cancelLoadSample=function(){document.getElementById("sample-preview").innerHTML="",document.getElementById("form-load-sample").reset(),document.getElementById("btn-check-sample-contents").style.display="block",document.getElementById("btn-load-sample").style.display="none",document.getElementById("btn-cancel-load-sample").style.display="none",document.getElementById("sampleFile").focus()},window.validateCI={__private__:{nodeClassesChange:function(e,t,n){if("string"==typeof t&&(t=[t]),!(e instanceof HTMLElement))throw new Error("Expected HTMLElement as first argument");if(!Array.isArray(t))throw new Error("Expected Array as second argument");if(-1===["add","remove"].indexOf(n))throw new Error("Expected add or remove as third parameter");t.map(t=>e.classList[n](t))},arrayLikeToArray:function(e){if(!("length"in e||"size"in e))throw new Error("Expected array-like object as argument");return Array.prototype.slice.call(e)}},checkCI:function(e){const t=e.type,n=document.getElementById("ciFileErrorPanel"),a=document.getElementById("ciFileErrorPanelBody"),l=document.getElementById("btn-load-ci"),r="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===t||"application/vnd.ms-excel"===t,i=r?"remove":"add",o=r?"add":"remove";this.__private__.nodeClassesChange(n,["panel","panel--simple","panel--error"],i),this.__private__.nodeClassesChange(a,["panel__body"],i),this.__private__.nodeClassesChange(l,["btn--disabled"],o),this.__private__.arrayLikeToArray(a.querySelectorAll("p:not(.field)")).forEach(e=>{this.__private__.nodeClassesChange(e,["hidden"],o),this.__private__.nodeClassesChange(l,["btn--disabled"],i)})},checkSelectedCI:function(e){window.FileReader&&validateCI.checkCI(e[0])}};