# Helper script documentation

## generate_csv_for_emails.py

This script is used to take input from the following 2 files:
 - Print file (generated by the actionexporter service and contains enrolment codes)
 - Respondent/Business excel file (generated by the business and contains contact details and the email 
 addresses we're sending to)

In addition, the script takes a number of arguments:
- Survey name.  Currently only 'construction' is valid but more will be in the future.  This name links to a mapping
with the proper survey name and phone number for the survey.
- Respondent period (Takes the form of "<Month> <Year>" e.g., "April 2020")
- Return by date (Takes the form of "<Day> <Month> <Year>" e.g., "07 May 2020")


A csv file is generated from these that will be uploaded to gov.notify(https://www.notifications.service.gov.uk/)
to send the ras-email-enrolment-code email.  This is currently being done as a special case during the covid-19 situation
as businesses aren't able to receive their enrolment code for surveys as they're not present at their registered office
address.

To run the script, do the following:
```bash
cd scripts
pipenv run python generate_csv_for_emails.py <business_filename> <print_filename> construction "April 2020" "07 May 2020"
```

This will generate a file called `enrolment_email_details.csv` which can be uploaded to gov notify via the
web interface to send emails.

Included in this folder is a file called `example_business_file.xlsx` which mimics the excel file the business
generates for us and can be used to generate example files.  There is also `example_print_file.csv` to mimic the print file
for testing.

